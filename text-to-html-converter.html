<p>&lt;!DOCTYPE html&gt;</p><p>&lt;html lang="zh-CN"&gt;</p><p>&lt;head&gt;</p><p>    &lt;meta charset="UTF-8"&gt;</p><p>    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p><p>    &lt;title&gt;商品管理系统&lt;/title&gt;</p><p>    &lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p><p>    &lt;script src="https://apis.google.com/js/api.js"&gt;&lt;/script&gt;</p><p>    &lt;script src="https://accounts.google.com/gsi/client"&gt;&lt;/script&gt;</p><p>    &lt;script&gt;</p><p>        tailwind.config = {</p><p>            theme: {</p><p>                extend: {</p><p>                    colors: {</p><p>                        primary: '#5D5CDE'</p><p>                    }</p><p>                }</p><p>            }</p><p>        }</p><p>    &lt;/script&gt;</p><p>    &lt;style&gt;</p><p>        .modal-overlay {</p><p>            backdrop-filter: blur(4px);</p><p>        }</p><p>        .product-image {</p><p>            aspect-ratio: 1600/2048;</p><p>            object-fit: cover;</p><p>        }</p><p>        .sync-indicator {</p><p>            animation: spin 1s linear infinite;</p><p>        }</p><p>        @keyframes spin {</p><p>            from { transform: rotate(0deg); }</p><p>            to { transform: rotate(360deg); }</p><p>        }</p><p>    &lt;/style&gt;</p><p>&lt;/head&gt;</p><p>&lt;body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-white"&gt;</p><p>    &lt;!-- 登录页面 --&gt;</p><p>    &lt;div id="loginPage" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/10 to-purple-100 dark:from-primary/20 dark:to-gray-800"&gt;</p><p>        &lt;div class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-md mx-4"&gt;</p><p>            &lt;div class="text-center mb-8"&gt;</p><p>                &lt;h1 class="text-3xl font-bold text-primary mb-2"&gt;商品管理系统&lt;/h1&gt;</p><p>                &lt;p class="text-gray-600 dark:text-gray-400"&gt;请登录以继续&lt;/p&gt;</p><p>            &lt;/div&gt;</p><p>            </p><p>            &lt;form id="loginForm" class="space-y-6"&gt;</p><p>                &lt;div&gt;</p><p>                    &lt;label class="block text-sm font-medium mb-2"&gt;用户名&lt;/label&gt;</p><p>                    &lt;input type="text" id="username" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white text-base" required&gt;</p><p>                &lt;/div&gt;</p><p>                </p><p>                &lt;div&gt;</p><p>                    &lt;label class="block text-sm font-medium mb-2"&gt;密码&lt;/label&gt;</p><p>                    &lt;input type="password" id="password" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white text-base" required&gt;</p><p>                &lt;/div&gt;</p><p>                </p><p>                &lt;button type="submit" class="w-full bg-primary text-white py-3 rounded-lg hover:bg-primary/90 transition-colors font-medium"&gt;</p><p>                    登录</p><p>                &lt;/button&gt;</p><p>            &lt;/form&gt;</p><p>            </p><p>            &lt;!-- Google Drive 同步设置 --&gt;</p><p>            &lt;div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700"&gt;</p><p>                &lt;div class="text-sm font-medium mb-3 text-center"&gt;云端数据同步&lt;/div&gt;</p><p>                &lt;div id="googleDriveStatus" class="text-center text-sm text-gray-600 dark:text-gray-400 mb-3"&gt;</p><p>                    未连接 Google Drive</p><p>                &lt;/div&gt;</p><p>                &lt;button id="googleSignInBtn" class="w-full bg-red-500 text-white py-2 rounded-lg hover:bg-red-600 transition-colors text-sm"&gt;</p><p>                    连接 Google Drive</p><p>                &lt;/button&gt;</p><p>                &lt;button id="googleSignOutBtn" class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors text-sm hidden"&gt;</p><p>                    断开 Google Drive</p><p>                &lt;/button&gt;</p><p>            &lt;/div&gt;</p><p>            </p><p>            &lt;div id="loginError" class="mt-4 text-red-500 text-sm text-center hidden"&gt;&lt;/div&gt;</p><p>        &lt;/div&gt;</p><p>    &lt;/div&gt;</p><p><br></p><p>    &lt;!-- 主应用界面 --&gt;</p><p>    &lt;div id="mainApp" class="hidden min-h-screen"&gt;</p><p>        &lt;!-- 顶部导航栏 --&gt;</p><p>        &lt;nav class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700"&gt;</p><p>            &lt;div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"&gt;</p><p>                &lt;div class="flex justify-between items-center h-16"&gt;</p><p>                    &lt;div class="flex items-center space-x-4"&gt;</p><p>                        &lt;h1 class="text-xl font-semibold text-primary"&gt;商品管理系统&lt;/h1&gt;</p><p>                        &lt;span id="userInfo" class="text-sm text-gray-600 dark:text-gray-400"&gt;&lt;/span&gt;</p><p>                        &lt;!-- 同步状态指示器 --&gt;</p><p>                        &lt;div class="flex items-center space-x-2"&gt;</p><p>                            &lt;div id="syncStatus" class="text-xs text-gray-500 dark:text-gray-400"&gt;离线模式&lt;/div&gt;</p><p>                            &lt;div id="syncIndicator" class="w-3 h-3 bg-gray-400 rounded-full"&gt;&lt;/div&gt;</p><p>                        &lt;/div&gt;</p><p>                    &lt;/div&gt;</p><p>                    </p><p>                    &lt;div class="flex items-center space-x-4"&gt;</p><p>                        &lt;button id="dashboardBtn" class="nav-btn bg-primary text-white px-4 py-2 rounded-lg"&gt;商品管理&lt;/button&gt;</p><p>                        &lt;button id="userManagementBtn" class="nav-btn text-gray-600 dark:text-gray-400 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 hidden"&gt;用户管理&lt;/button&gt;</p><p>                        &lt;button id="categoryManagementBtn" class="nav-btn text-gray-600 dark:text-gray-400 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"&gt;分类管理&lt;/button&gt;</p><p>                        &lt;button id="statsBtn" class="nav-btn text-gray-600 dark:text-gray-400 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"&gt;统计&lt;/button&gt;</p><p>                        &lt;button id="syncBtn" class="text-blue-500 hover:text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20"&gt;手动同步&lt;/button&gt;</p><p>                        &lt;button id="logoutBtn" class="text-red-500 hover:text-red-700 px-4 py-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20"&gt;登出&lt;/button&gt;</p><p>                    &lt;/div&gt;</p><p>                &lt;/div&gt;</p><p>            &lt;/div&gt;</p><p>        &lt;/nav&gt;</p><p><br></p><p>        &lt;!-- 商品管理界面 --&gt;</p><p>        &lt;div id="dashboardContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"&gt;</p><p>            &lt;!-- 搜索和添加商品栏 --&gt;</p><p>            &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 mb-8"&gt;</p><p>                &lt;div class="flex flex-col sm:flex-row gap-4 items-end"&gt;</p><p>                    &lt;div class="flex-1"&gt;</p><p>                        &lt;label class="block text-sm font-medium mb-2"&gt;搜索商品&lt;/label&gt;</p><p>                        &lt;input type="text" id="searchInput" placeholder="输入商品名称搜索..." class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 text-base"&gt;</p><p>                    &lt;/div&gt;</p><p>                    &lt;button id="addProductBtn" class="bg-primary text-white px-6 py-3 rounded-lg hover:bg-primary/90 transition-colors whitespace-nowrap"&gt;</p><p>                        添加商品</p><p>                    &lt;/button&gt;</p><p>                &lt;/div&gt;</p><p>            &lt;/div&gt;</p><p><br></p><p>            &lt;!-- 统计卡片 --&gt;</p><p>            &lt;div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"&gt;</p><p>                &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6"&gt;</p><p>                    &lt;div class="text-sm text-gray-600 dark:text-gray-400 mb-1"&gt;商品总数&lt;/div&gt;</p><p>                    &lt;div id="totalProducts" class="text-2xl font-bold text-primary"&gt;0&lt;/div&gt;</p><p>                &lt;/div&gt;</p><p>                &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6"&gt;</p><p>                    &lt;div class="text-sm text-gray-600 dark:text-gray-400 mb-1"&gt;已售商品&lt;/div&gt;</p><p>                    &lt;div id="soldProducts" class="text-2xl font-bold text-green-500"&gt;0&lt;/div&gt;</p><p>                &lt;/div&gt;</p><p>                &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6"&gt;</p><p>                    &lt;div class="text-sm text-gray-600 dark:text-gray-400 mb-1"&gt;库存商品&lt;/div&gt;</p><p>                    &lt;div id="stockProducts" class="text-2xl font-bold text-blue-500"&gt;0&lt;/div&gt;</p><p>                &lt;/div&gt;</p><p>                &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6"&gt;</p><p>                    &lt;div class="text-sm text-gray-600 dark:text-gray-400 mb-1"&gt;总价值&lt;/div&gt;</p><p>                    &lt;div id="totalValue" class="text-2xl font-bold text-purple-500"&gt;¥0&lt;/div&gt;</p><p>                &lt;/div&gt;</p><p>            &lt;/div&gt;</p><p><br></p><p>            &lt;!-- 商品列表 --&gt;</p><p>            &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm"&gt;</p><p>                &lt;div class="p-6 border-b border-gray-200 dark:border-gray-700"&gt;</p><p>                    &lt;h2 class="text-lg font-semibold"&gt;商品列表&lt;/h2&gt;</p><p>                &lt;/div&gt;</p><p>                &lt;div id="productsList" class="p-6"&gt;</p><p>                    &lt;div class="text-center py-12 text-gray-500 dark:text-gray-400"&gt;</p><p>                        暂无商品数据</p><p>                    &lt;/div&gt;</p><p>                &lt;/div&gt;</p><p>            &lt;/div&gt;</p><p>        &lt;/div&gt;</p><p><br></p><p>        &lt;!-- 用户管理界面 --&gt;</p><p>        &lt;div id="userManagementContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden"&gt;</p><p>            &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm"&gt;</p><p>                &lt;div class="p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"&gt;</p><p>                    &lt;h2 class="text-lg font-semibold"&gt;用户管理&lt;/h2&gt;</p><p>                    &lt;button id="addUserBtn" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90"&gt;</p><p>                        添加员工</p><p>                    &lt;/button&gt;</p><p>                &lt;/div&gt;</p><p>                &lt;div id="usersList" class="p-6"&gt;</p><p>                    &lt;!-- 用户列表将在这里生成 --&gt;</p><p>                &lt;/div&gt;</p><p>            &lt;/div&gt;</p><p>        &lt;/div&gt;</p><p><br></p><p>        &lt;!-- 分类管理界面 --&gt;</p><p>        &lt;div id="categoryManagementContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden"&gt;</p><p>            &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm"&gt;</p><p>                &lt;div class="p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"&gt;</p><p>                    &lt;h2 class="text-lg font-semibold"&gt;分类管理&lt;/h2&gt;</p><p>                    &lt;button id="addCategoryBtn" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90"&gt;</p><p>                        添加分类</p><p>                    &lt;/button&gt;</p><p>                &lt;/div&gt;</p><p>                &lt;div id="categoriesList" class="p-6"&gt;</p><p>                    &lt;!-- 分类列表将在这里生成 --&gt;</p><p>                &lt;/div&gt;</p><p>            &lt;/div&gt;</p><p>        &lt;/div&gt;</p><p><br></p><p>        &lt;!-- 统计界面 --&gt;</p><p>        &lt;div id="statsContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden"&gt;</p><p>            &lt;div class="grid grid-cols-1 lg:grid-cols-2 gap-8"&gt;</p><p>                &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6"&gt;</p><p>                    &lt;h3 class="text-lg font-semibold mb-4"&gt;分类统计&lt;/h3&gt;</p><p>                    &lt;div id="categoryStats"&gt;</p><p>                        &lt;!-- 分类统计将在这里生成 --&gt;</p><p>                    &lt;/div&gt;</p><p>                &lt;/div&gt;</p><p>                &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6"&gt;</p><p>                    &lt;h3 class="text-lg font-semibold mb-4"&gt;销售统计&lt;/h3&gt;</p><p>                    &lt;div id="salesStats"&gt;</p><p>                        &lt;!-- 销售统计将在这里生成 --&gt;</p><p>                    &lt;/div&gt;</p><p>                &lt;/div&gt;</p><p>            &lt;/div&gt;</p><p>        &lt;/div&gt;</p><p>    &lt;/div&gt;</p><p><br></p><p>    &lt;!-- 添加/编辑商品模态框 --&gt;</p><p>    &lt;div id="productModal" class="fixed inset-0 bg-black bg-opacity-50 modal-overlay hidden flex items-center justify-center z-50"&gt;</p><p>        &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto"&gt;</p><p>            &lt;div class="p-6 border-b border-gray-200 dark:border-gray-700"&gt;</p><p>                &lt;h3 id="productModalTitle" class="text-lg font-semibold"&gt;添加商品&lt;/h3&gt;</p><p>            &lt;/div&gt;</p><p>            &lt;form id="productForm" class="p-6 space-y-4"&gt;</p><p>                &lt;div&gt;</p><p>                    &lt;label class="block text-sm font-medium mb-2"&gt;商品名称 *&lt;/label&gt;</p><p>                    &lt;input type="text" id="productName" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 text-base" required&gt;</p><p>                &lt;/div&gt;</p><p>                </p><p>                &lt;div&gt;</p><p>                    &lt;label class="block text-sm font-medium mb-2"&gt;商品图片&lt;/label&gt;</p><p>                    &lt;div class="space-y-3"&gt;</p><p>                        &lt;input type="file" id="productImage" accept="image/*" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 text-base"&gt;</p><p>                        &lt;div id="imagePreview" class="hidden"&gt;</p><p>                            &lt;img id="previewImg" class="product-image w-full max-w-xs mx-auto rounded-lg border"&gt;</p><p>                        &lt;/div&gt;</p><p>                    &lt;/div&gt;</p><p>                &lt;/div&gt;</p><p>                </p><p>                &lt;div&gt;</p><p>                    &lt;label class="block text-sm font-medium mb-2"&gt;商品分类 *&lt;/label&gt;</p><p>                    &lt;select id="productCategory" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 text-base" required&gt;</p><p>                        &lt;option value=""&gt;请选择分类&lt;/option&gt;</p><p>                    &lt;/select&gt;</p><p>                &lt;/div&gt;</p><p>                </p><p>                &lt;div class="grid grid-cols-2 gap-4"&gt;</p><p>                    &lt;div&gt;</p><p>                        &lt;label class="block text-sm font-medium mb-2"&gt;售价 *&lt;/label&gt;</p><p>                        &lt;input type="number" id="productPrice" step="0.01" min="0" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 text-base" required&gt;</p><p>                    &lt;/div&gt;</p><p>                    &lt;div&gt;</p><p>                        &lt;label class="block text-sm font-medium mb-2"&gt;库存 *&lt;/label&gt;</p><p>                        &lt;input type="number" id="productStock" min="0" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 text-base" required&gt;</p><p>                    &lt;/div&gt;</p><p>                &lt;/div&gt;</p><p>                </p><p>                &lt;div&gt;</p><p>                    &lt;label class="flex items-center space-x-2"&gt;</p><p>                        &lt;input type="checkbox" id="productSold" class="w-5 h-5 text-primary focus:ring-primary border-gray-300 rounded"&gt;</p><p>                        &lt;span class="text-sm font-medium"&gt;已售出&lt;/span&gt;</p><p>                    &lt;/label&gt;</p><p>                &lt;/div&gt;</p><p>                </p><p>                &lt;div class="flex justify-end space-x-3 pt-4"&gt;</p><p>                    &lt;button type="button" id="cancelProductBtn" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"&gt;取消&lt;/button&gt;</p><p>                    &lt;button type="submit" class="px-4 py-2 bg-primary text-white hover:bg-primary/90 rounded-lg"&gt;保存&lt;/button&gt;</p><p>                &lt;/div&gt;</p><p>            &lt;/form&gt;</p><p>        &lt;/div&gt;</p><p>    &lt;/div&gt;</p><p><br></p><p>    &lt;!-- 添加用户模态框 --&gt;</p><p>    &lt;div id="userModal" class="fixed inset-0 bg-black bg-opacity-50 modal-overlay hidden flex items-center justify-center z-50"&gt;</p><p>        &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md mx-4"&gt;</p><p>            &lt;div class="p-6 border-b border-gray-200 dark:border-gray-700"&gt;</p><p>                &lt;h3 id="userModalTitle" class="text-lg font-semibold"&gt;添加员工&lt;/h3&gt;</p><p>            &lt;/div&gt;</p><p>            &lt;form id="userForm" class="p-6 space-y-4"&gt;</p><p>                &lt;div&gt;</p><p>                    &lt;label class="block text-sm font-medium mb-2"&gt;用户名 *&lt;/label&gt;</p><p>                    &lt;input type="text" id="newUsername" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 text-base" required&gt;</p><p>                &lt;/div&gt;</p><p>                </p><p>                &lt;div&gt;</p><p>                    &lt;label class="block text-sm font-medium mb-2"&gt;密码 *&lt;/label&gt;</p><p>                    &lt;input type="password" id="newPassword" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 text-base" required&gt;</p><p>                &lt;/div&gt;</p><p>                </p><p>                &lt;div&gt;</p><p>                    &lt;label class="block text-sm font-medium mb-2"&gt;用户类型 *&lt;/label&gt;</p><p>                    &lt;select id="userRole" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 text-base" required&gt;</p><p>                        &lt;option value="employee"&gt;员工&lt;/option&gt;</p><p>                        &lt;option value="admin"&gt;管理员&lt;/option&gt;</p><p>                    &lt;/select&gt;</p><p>                &lt;/div&gt;</p><p>                </p><p>                &lt;div class="flex justify-end space-x-3 pt-4"&gt;</p><p>                    &lt;button type="button" id="cancelUserBtn" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"&gt;取消&lt;/button&gt;</p><p>                    &lt;button type="submit" class="px-4 py-2 bg-primary text-white hover:bg-primary/90 rounded-lg"&gt;保存&lt;/button&gt;</p><p>                &lt;/div&gt;</p><p>            &lt;/form&gt;</p><p>        &lt;/div&gt;</p><p>    &lt;/div&gt;</p><p><br></p><p>    &lt;!-- 添加分类模态框 --&gt;</p><p>    &lt;div id="categoryModal" class="fixed inset-0 bg-black bg-opacity-50 modal-overlay hidden flex items-center justify-center z-50"&gt;</p><p>        &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md mx-4"&gt;</p><p>            &lt;div class="p-6 border-b border-gray-200 dark:border-gray-700"&gt;</p><p>                &lt;h3 class="text-lg font-semibold"&gt;添加分类&lt;/h3&gt;</p><p>            &lt;/div&gt;</p><p>            &lt;form id="categoryForm" class="p-6 space-y-4"&gt;</p><p>                &lt;div&gt;</p><p>                    &lt;label class="block text-sm font-medium mb-2"&gt;分类名称 *&lt;/label&gt;</p><p>                    &lt;input type="text" id="categoryName" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 text-base" required&gt;</p><p>                &lt;/div&gt;</p><p>                </p><p>                &lt;div class="flex justify-end space-x-3 pt-4"&gt;</p><p>                    &lt;button type="button" id="cancelCategoryBtn" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"&gt;取消&lt;/button&gt;</p><p>                    &lt;button type="submit" class="px-4 py-2 bg-primary text-white hover:bg-primary/90 rounded-lg"&gt;保存&lt;/button&gt;</p><p>                &lt;/div&gt;</p><p>            &lt;/form&gt;</p><p>        &lt;/div&gt;</p><p>    &lt;/div&gt;</p><p><br></p><p>    &lt;!-- 确认删除模态框 --&gt;</p><p>    &lt;div id="confirmModal" class="fixed inset-0 bg-black bg-opacity-50 modal-overlay hidden flex items-center justify-center z-50"&gt;</p><p>        &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-sm mx-4"&gt;</p><p>            &lt;div class="p-6"&gt;</p><p>                &lt;h3 class="text-lg font-semibold mb-4"&gt;确认删除&lt;/h3&gt;</p><p>                &lt;p id="confirmMessage" class="text-gray-600 dark:text-gray-400 mb-6"&gt;确定要删除此项目吗？此操作无法撤销。&lt;/p&gt;</p><p>                &lt;div class="flex justify-end space-x-3"&gt;</p><p>                    &lt;button id="cancelConfirmBtn" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"&gt;取消&lt;/button&gt;</p><p>                    &lt;button id="confirmDeleteBtn" class="px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded-lg"&gt;删除&lt;/button&gt;</p><p>                &lt;/div&gt;</p><p>            &lt;/div&gt;</p><p>        &lt;/div&gt;</p><p>    &lt;/div&gt;</p><p><br></p><p>    &lt;script&gt;</p><p>        // Google Drive API 配置</p><p>        // ⚠️ 重要：请将这些配置替换为你的真实值</p><p>        const GOOGLE_CONFIG = {</p><p>            apiKey: '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', // 必须替换为你的真实 API Key</p><p>            clientId: '691174024369-ifphfad307tldfj7l1ueicb7iucptj48.apps.googleusercontent.com', // 必须替换为你的真实 Client ID</p><p>            discoveryDoc: 'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest',</p><p>            scopes: 'https://www.googleapis.com/auth/drive.file',</p><p>            dataFileName: 'inventory_system_data.json'</p><p>        };</p><p><br></p><p>        // 检查配置是否已更新</p><p>        function checkGoogleConfig() {</p><p>            if (GOOGLE_CONFIG.apiKey === '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' || </p><p>                GOOGLE_CONFIG.clientId === '691174024369-ifphfad307tldfj7l1ueicb7iucptj48.apps.googleusercontent.com') {</p><p>                console.error('⚠️ Google Drive 配置未更新！请设置正确的 API Key 和 Client ID');</p><p>                return false;</p><p>            }</p><p>            return true;</p><p>        }</p><p><br></p><p>        // 深色模式支持</p><p>        if (window.matchMedia &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches) {</p><p>            document.documentElement.classList.add('dark');</p><p>        }</p><p>        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event =&gt; {</p><p>            if (event.matches) {</p><p>                document.documentElement.classList.add('dark');</p><p>            } else {</p><p>                document.documentElement.classList.remove('dark');</p><p>            }</p><p>        });</p><p><br></p><p>        // Google Drive API 管理类</p><p>        class GoogleDriveSync {</p><p>            constructor() {</p><p>                this.isSignedIn = false;</p><p>                this.gapi = null;</p><p>                this.tokenClient = null;</p><p>                this.dataFileId = null;</p><p>                this.callbacks = {</p><p>                    onSignIn: null,</p><p>                    onSignOut: null,</p><p>                    onSync: null,</p><p>                    onError: null</p><p>                };</p><p>            }</p><p><br></p><p>            async init() {</p><p>                try {</p><p>                    // 初始化 Google API</p><p>                    await new Promise((resolve) =&gt; {</p><p>                        gapi.load('auth2:client', resolve);</p><p>                    });</p><p><br></p><p>                    await gapi.client.init({</p><p>                        apiKey: GOOGLE_CONFIG.apiKey,</p><p>                        discoveryDocs: [GOOGLE_CONFIG.discoveryDoc]</p><p>                    });</p><p><br></p><p>                    // 初始化 Google Identity Services</p><p>                    this.tokenClient = google.accounts.oauth2.initTokenClient({</p><p>                        client_id: GOOGLE_CONFIG.clientId,</p><p>                        scope: GOOGLE_CONFIG.scopes,</p><p>                        callback: (response) =&gt; {</p><p>                            if (response.access_token) {</p><p>                                this.handleSignInSuccess();</p><p>                            }</p><p>                        }</p><p>                    });</p><p><br></p><p>                    console.log('Google Drive API 初始化成功');</p><p>                    return true;</p><p>                } catch (error) {</p><p>                    console.error('Google Drive API 初始化失败:', error);</p><p>                    return false;</p><p>                }</p><p>            }</p><p><br></p><p>            signIn() {</p><p>                if (this.tokenClient) {</p><p>                    this.tokenClient.requestAccessToken();</p><p>                }</p><p>            }</p><p><br></p><p>            signOut() {</p><p>                const token = gapi.client.getToken();</p><p>                if (token !== null) {</p><p>                    google.accounts.oauth2.revoke(token.access_token);</p><p>                    gapi.client.setToken('');</p><p>                    this.isSignedIn = false;</p><p>                    this.dataFileId = null;</p><p>                    if (this.callbacks.onSignOut) {</p><p>                        this.callbacks.onSignOut();</p><p>                    }</p><p>                }</p><p>            }</p><p><br></p><p>            handleSignInSuccess() {</p><p>                this.isSignedIn = true;</p><p>                if (this.callbacks.onSignIn) {</p><p>                    this.callbacks.onSignIn();</p><p>                }</p><p>                // 登录成功后自动加载数据</p><p>                this.loadDataFromDrive();</p><p>            }</p><p><br></p><p>            async findDataFile() {</p><p>                try {</p><p>                    const response = await gapi.client.drive.files.list({</p><p>                        q: `name='${GOOGLE_CONFIG.dataFileName}' and trashed=false`,</p><p>                        spaces: 'drive'</p><p>                    });</p><p><br></p><p>                    if (response.result.files.length &gt; 0) {</p><p>                        this.dataFileId = response.result.files[0].id;</p><p>                        return this.dataFileId;</p><p>                    }</p><p>                    return null;</p><p>                } catch (error) {</p><p>                    console.error('查找数据文件失败:', error);</p><p>                    return null;</p><p>                }</p><p>            }</p><p><br></p><p>            async createDataFile(data) {</p><p>                try {</p><p>                    const metadata = {</p><p>                        name: GOOGLE_CONFIG.dataFileName,</p><p>                        parents: ['appDataFolder']</p><p>                    };</p><p><br></p><p>                    const form = new FormData();</p><p>                    form.append('metadata', new Blob([JSON.stringify(metadata)], {type: 'application/json'}));</p><p>                    form.append('file', new Blob([JSON.stringify(data)], {type: 'application/json'}));</p><p><br></p><p>                    const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {</p><p>                        method: 'POST',</p><p>                        headers: new Headers({</p><p>                            'Authorization': `Bearer ${gapi.auth.getToken().access_token}`</p><p>                        }),</p><p>                        body: form</p><p>                    });</p><p><br></p><p>                    if (response.ok) {</p><p>                        const result = await response.json();</p><p>                        this.dataFileId = result.id;</p><p>                        return result.id;</p><p>                    } else {</p><p>                        throw new Error('创建文件失败');</p><p>                    }</p><p>                } catch (error) {</p><p>                    console.error('创建数据文件失败:', error);</p><p>                    return null;</p><p>                }</p><p>            }</p><p><br></p><p>            async saveDataToDrive(data) {</p><p>                if (!this.isSignedIn) {</p><p>                    console.log('未登录 Google Drive，跳过同步');</p><p>                    return false;</p><p>                }</p><p><br></p><p>                try {</p><p>                    if (!this.dataFileId) {</p><p>                        await this.findDataFile();</p><p>                    }</p><p><br></p><p>                    const dataWithTimestamp = {</p><p>                        ...data,</p><p>                        lastSync: new Date().toISOString()</p><p>                    };</p><p><br></p><p>                    if (this.dataFileId) {</p><p>                        // 更新现有文件</p><p>                        const response = await fetch(`https://www.googleapis.com/upload/drive/v3/files/${this.dataFileId}?uploadType=media`, {</p><p>                            method: 'PATCH',</p><p>                            headers: {</p><p>                                'Authorization': `Bearer ${gapi.auth.getToken().access_token}`,</p><p>                                'Content-Type': 'application/json'</p><p>                            },</p><p>                            body: JSON.stringify(dataWithTimestamp)</p><p>                        });</p><p><br></p><p>                        if (!response.ok) {</p><p>                            throw new Error('更新文件失败');</p><p>                        }</p><p>                    } else {</p><p>                        // 创建新文件</p><p>                        this.dataFileId = await this.createDataFile(dataWithTimestamp);</p><p>                        if (!this.dataFileId) {</p><p>                            throw new Error('创建文件失败');</p><p>                        }</p><p>                    }</p><p><br></p><p>                    if (this.callbacks.onSync) {</p><p>                        this.callbacks.onSync('保存到云端成功');</p><p>                    }</p><p>                    return true;</p><p>                } catch (error) {</p><p>                    console.error('保存到 Google Drive 失败:', error);</p><p>                    if (this.callbacks.onError) {</p><p>                        this.callbacks.onError('保存到云端失败: ' + error.message);</p><p>                    }</p><p>                    return false;</p><p>                }</p><p>            }</p><p><br></p><p>            async loadDataFromDrive() {</p><p>                if (!this.isSignedIn) {</p><p>                    return null;</p><p>                }</p><p><br></p><p>                try {</p><p>                    if (!this.dataFileId) {</p><p>                        await this.findDataFile();</p><p>                    }</p><p><br></p><p>                    if (!this.dataFileId) {</p><p>                        console.log('云端未找到数据文件');</p><p>                        return null;</p><p>                    }</p><p><br></p><p>                    const response = await gapi.client.drive.files.get({</p><p>                        fileId: this.dataFileId,</p><p>                        alt: 'media'</p><p>                    });</p><p><br></p><p>                    if (response.body) {</p><p>                        const data = JSON.parse(response.body);</p><p>                        if (this.callbacks.onSync) {</p><p>                            this.callbacks.onSync('从云端加载成功');</p><p>                        }</p><p>                        return data;</p><p>                    }</p><p>                    return null;</p><p>                } catch (error) {</p><p>                    console.error('从 Google Drive 加载失败:', error);</p><p>                    if (this.callbacks.onError) {</p><p>                        this.callbacks.onError('从云端加载失败: ' + error.message);</p><p>                    }</p><p>                    return null;</p><p>                }</p><p>            }</p><p><br></p><p>            setCallbacks(callbacks) {</p><p>                this.callbacks = { ...this.callbacks, ...callbacks };</p><p>            }</p><p>        }</p><p><br></p><p>        // 数据存储类（增强版，支持云端同步）</p><p>        class DataStore {</p><p>            constructor() {</p><p>                this.data = {</p><p>                    users: [</p><p>                        { id: 1, username: 'admin', password: 'admin123', role: 'admin', status: 'active' }</p><p>                    ],</p><p>                    products: [],</p><p>                    categories: ['电子产品', '服装', '食品', '图书', '家居用品'],</p><p>                    currentUser: null,</p><p>                    nextProductId: 1,</p><p>                    nextUserId: 2</p><p>                };</p><p>                this.googleDrive = new GoogleDriveSync();</p><p>                this.autoSaveInterval = null;</p><p>                this.init();</p><p>            }</p><p><br></p><p>            async init() {</p><p>                // 初始化 Google Drive</p><p>                await this.googleDrive.init();</p><p>                </p><p>                // 设置 Google Drive 回调</p><p>                this.googleDrive.setCallbacks({</p><p>                    onSignIn: () =&gt; {</p><p>                        this.updateGoogleDriveStatus(true);</p><p>                        this.startAutoSave();</p><p>                    },</p><p>                    onSignOut: () =&gt; {</p><p>                        this.updateGoogleDriveStatus(false);</p><p>                        this.stopAutoSave();</p><p>                    },</p><p>                    onSync: (message) =&gt; {</p><p>                        this.updateSyncStatus('success', message);</p><p>                    },</p><p>                    onError: (message) =&gt; {</p><p>                        this.updateSyncStatus('error', message);</p><p>                    }</p><p>                });</p><p><br></p><p>                // 添加一些示例商品</p><p>                this.addProduct({</p><p>                    name: '示例商品1',</p><p>                    image: null,</p><p>                    category: '电子产品',</p><p>                    price: 299.99,</p><p>                    stock: 10,</p><p>                    sold: false</p><p>                });</p><p>                this.addProduct({</p><p>                    name: '示例商品2',</p><p>                    image: null,</p><p>                    category: '服装',</p><p>                    price: 89.99,</p><p>                    stock: 5,</p><p>                    sold: true</p><p>                });</p><p>            }</p><p><br></p><p>            updateGoogleDriveStatus(isConnected) {</p><p>                const statusElement = document.getElementById('googleDriveStatus');</p><p>                const signInBtn = document.getElementById('googleSignInBtn');</p><p>                const signOutBtn = document.getElementById('googleSignOutBtn');</p><p>                const syncIndicator = document.getElementById('syncIndicator');</p><p>                const syncStatus = document.getElementById('syncStatus');</p><p><br></p><p>                if (isConnected) {</p><p>                    statusElement.textContent = '已连接 Google Drive';</p><p>                    statusElement.className = 'text-center text-sm text-green-600 dark:text-green-400 mb-3';</p><p>                    signInBtn.classList.add('hidden');</p><p>                    signOutBtn.classList.remove('hidden');</p><p>                    </p><p>                    syncIndicator.className = 'w-3 h-3 bg-green-400 rounded-full';</p><p>                    syncStatus.textContent = '云端同步已启用';</p><p>                } else {</p><p>                    statusElement.textContent = '未连接 Google Drive';</p><p>                    statusElement.className = 'text-center text-sm text-gray-600 dark:text-gray-400 mb-3';</p><p>                    signInBtn.classList.remove('hidden');</p><p>                    signOutBtn.classList.add('hidden');</p><p>                    </p><p>                    syncIndicator.className = 'w-3 h-3 bg-gray-400 rounded-full';</p><p>                    syncStatus.textContent = '离线模式';</p><p>                }</p><p>            }</p><p><br></p><p>            updateSyncStatus(type, message) {</p><p>                const syncStatus = document.getElementById('syncStatus');</p><p>                const syncIndicator = document.getElementById('syncIndicator');</p><p>                </p><p>                if (type === 'syncing') {</p><p>                    syncIndicator.className = 'w-3 h-3 bg-blue-400 rounded-full sync-indicator';</p><p>                    syncStatus.textContent = message || '正在同步...';</p><p>                } else if (type === 'success') {</p><p>                    syncIndicator.className = 'w-3 h-3 bg-green-400 rounded-full';</p><p>                    syncStatus.textContent = message || '同步成功';</p><p>                    setTimeout(() =&gt; {</p><p>                        if (this.googleDrive.isSignedIn) {</p><p>                            syncStatus.textContent = '云端同步已启用';</p><p>                        }</p><p>                    }, 3000);</p><p>                } else if (type === 'error') {</p><p>                    syncIndicator.className = 'w-3 h-3 bg-red-400 rounded-full';</p><p>                    syncStatus.textContent = message || '同步失败';</p><p>                    setTimeout(() =&gt; {</p><p>                        if (this.googleDrive.isSignedIn) {</p><p>                            syncStatus.textContent = '云端同步已启用';</p><p>                            syncIndicator.className = 'w-3 h-3 bg-green-400 rounded-full';</p><p>                        }</p><p>                    }, 5000);</p><p>                }</p><p>            }</p><p><br></p><p>            startAutoSave() {</p><p>                this.stopAutoSave(); // 确保不会重复启动</p><p>                this.autoSaveInterval = setInterval(() =&gt; {</p><p>                    this.syncToCloud();</p><p>                }, 30000); // 每30秒自动保存一次</p><p>            }</p><p><br></p><p>            stopAutoSave() {</p><p>                if (this.autoSaveInterval) {</p><p>                    clearInterval(this.autoSaveInterval);</p><p>                    this.autoSaveInterval = null;</p><p>                }</p><p>            }</p><p><br></p><p>            async syncToCloud() {</p><p>                if (this.googleDrive.isSignedIn) {</p><p>                    this.updateSyncStatus('syncing', '正在同步到云端...');</p><p>                    await this.googleDrive.saveDataToDrive(this.getDataForSync());</p><p>                }</p><p>            }</p><p><br></p><p>            async loadFromCloud() {</p><p>                if (this.googleDrive.isSignedIn) {</p><p>                    this.updateSyncStatus('syncing', '正在从云端加载...');</p><p>                    const cloudData = await this.googleDrive.loadDataFromDrive();</p><p>                    if (cloudData) {</p><p>                        this.mergeCloudData(cloudData);</p><p>                        return true;</p><p>                    }</p><p>                }</p><p>                return false;</p><p>            }</p><p><br></p><p>            getDataForSync() {</p><p>                // 返回需要同步的数据（排除当前用户信息）</p><p>                return {</p><p>                    users: this.data.users,</p><p>                    products: this.data.products,</p><p>                    categories: this.data.categories,</p><p>                    nextProductId: this.data.nextProductId,</p><p>                    nextUserId: this.data.nextUserId</p><p>                };</p><p>            }</p><p><br></p><p>            mergeCloudData(cloudData) {</p><p>                // 合并云端数据，保持当前登录状态</p><p>                const currentUser = this.data.currentUser;</p><p>                </p><p>                this.data = {</p><p>                    ...this.data,</p><p>                    ...cloudData,</p><p>                    currentUser: currentUser // 保持当前登录用户</p><p>                };</p><p>            }</p><p><br></p><p>            // Google Drive 相关方法</p><p>            async connectGoogleDrive() {</p><p>                this.googleDrive.signIn();</p><p>            }</p><p><br></p><p>            disconnectGoogleDrive() {</p><p>                this.googleDrive.signOut();</p><p>            }</p><p><br></p><p>            // 原有方法保持不变，但添加自动同步</p><p>            getUsers() {</p><p>                return this.data.users;</p><p>            }</p><p><br></p><p>            addUser(userData) {</p><p>                const user = {</p><p>                    id: this.data.nextUserId++,</p><p>                    ...userData,</p><p>                    status: 'active'</p><p>                };</p><p>                this.data.users.push(user);</p><p>                this.syncToCloud(); // 自动同步</p><p>                return user;</p><p>            }</p><p><br></p><p>            updateUser(id, userData) {</p><p>                const index = this.data.users.findIndex(u =&gt; u.id === id);</p><p>                if (index !== -1) {</p><p>                    this.data.users[index] = { ...this.data.users[index], ...userData };</p><p>                    this.syncToCloud(); // 自动同步</p><p>                    return this.data.users[index];</p><p>                }</p><p>                return null;</p><p>            }</p><p><br></p><p>            deleteUser(id) {</p><p>                const index = this.data.users.findIndex(u =&gt; u.id === id);</p><p>                if (index !== -1) {</p><p>                    this.data.users.splice(index, 1);</p><p>                    this.syncToCloud(); // 自动同步</p><p>                    return true;</p><p>                }</p><p>                return false;</p><p>            }</p><p><br></p><p>            getProducts() {</p><p>                return this.data.products;</p><p>            }</p><p><br></p><p>            addProduct(productData) {</p><p>                const product = {</p><p>                    id: this.data.nextProductId++,</p><p>                    ...productData,</p><p>                    createdAt: new Date().toISOString()</p><p>                };</p><p>                this.data.products.push(product);</p><p>                this.syncToCloud(); // 自动同步</p><p>                return product;</p><p>            }</p><p><br></p><p>            updateProduct(id, productData) {</p><p>                const index = this.data.products.findIndex(p =&gt; p.id === id);</p><p>                if (index !== -1) {</p><p>                    this.data.products[index] = { ...this.data.products[index], ...productData };</p><p>                    this.syncToCloud(); // 自动同步</p><p>                    return this.data.products[index];</p><p>                }</p><p>                return null;</p><p>            }</p><p><br></p><p>            deleteProduct(id) {</p><p>                const index = this.data.products.findIndex(p =&gt; p.id === id);</p><p>                if (index !== -1) {</p><p>                    this.data.products.splice(index, 1);</p><p>                    this.syncToCloud(); // 自动同步</p><p>                    return true;</p><p>                }</p><p>                return false;</p><p>            }</p><p><br></p><p>            getCategories() {</p><p>                return this.data.categories;</p><p>            }</p><p><br></p><p>            addCategory(categoryName) {</p><p>                if (!this.data.categories.includes(categoryName)) {</p><p>                    this.data.categories.push(categoryName);</p><p>                    this.syncToCloud(); // 自动同步</p><p>                    return true;</p><p>                }</p><p>                return false;</p><p>            }</p><p><br></p><p>            deleteCategory(categoryName) {</p><p>                const index = this.data.categories.indexOf(categoryName);</p><p>                if (index !== -1) {</p><p>                    this.data.categories.splice(index, 1);</p><p>                    this.syncToCloud(); // 自动同步</p><p>                    return true;</p><p>                }</p><p>                return false;</p><p>            }</p><p><br></p><p>            authenticate(username, password) {</p><p>                const user = this.data.users.find(u =&gt; </p><p>                    u.username === username &amp;&amp; </p><p>                    u.password === password &amp;&amp; </p><p>                    u.status === 'active'</p><p>                );</p><p>                if (user) {</p><p>                    this.data.currentUser = user;</p><p>                    return user;</p><p>                }</p><p>                return null;</p><p>            }</p><p><br></p><p>            getCurrentUser() {</p><p>                return this.data.currentUser;</p><p>            }</p><p><br></p><p>            logout() {</p><p>                this.data.currentUser = null;</p><p>            }</p><p>        }</p><p><br></p><p>        // 应用程序主类</p><p>        class InventoryApp {</p><p>            constructor() {</p><p>                this.store = new DataStore();</p><p>                this.currentEditingProduct = null;</p><p>                this.currentEditingUser = null;</p><p>                this.confirmCallback = null;</p><p>                this.init();</p><p>            }</p><p><br></p><p>            async init() {</p><p>                this.bindEvents();</p><p>                this.showLoginPage();</p><p>                </p><p>                // 等待 Google Drive 初始化完成</p><p>                await new Promise(resolve =&gt; setTimeout(resolve, 1000));</p><p>            }</p><p><br></p><p>            bindEvents() {</p><p>                // 登录相关</p><p>                document.getElementById('loginForm').addEventListener('submit', (e) =&gt; {</p><p>                    e.preventDefault();</p><p>                    this.handleLogin();</p><p>                });</p><p><br></p><p>                document.getElementById('logoutBtn').addEventListener('click', () =&gt; {</p><p>                    this.handleLogout();</p><p>                });</p><p><br></p><p>                // Google Drive 相关</p><p>                document.getElementById('googleSignInBtn').addEventListener('click', () =&gt; {</p><p>                    this.store.connectGoogleDrive();</p><p>                });</p><p><br></p><p>                document.getElementById('googleSignOutBtn').addEventListener('click', () =&gt; {</p><p>                    this.store.disconnectGoogleDrive();</p><p>                });</p><p><br></p><p>                document.getElementById('syncBtn').addEventListener('click', () =&gt; {</p><p>                    this.manualSync();</p><p>                });</p><p><br></p><p>                // 导航相关</p><p>                document.getElementById('dashboardBtn').addEventListener('click', () =&gt; {</p><p>                    this.showDashboard();</p><p>                });</p><p><br></p><p>                document.getElementById('userManagementBtn').addEventListener('click', () =&gt; {</p><p>                    this.showUserManagement();</p><p>                });</p><p><br></p><p>                document.getElementById('categoryManagementBtn').addEventListener('click', () =&gt; {</p><p>                    this.showCategoryManagement();</p><p>                });</p><p><br></p><p>                document.getElementById('statsBtn').addEventListener('click', () =&gt; {</p><p>                    this.showStats();</p><p>                });</p><p><br></p><p>                // 搜索</p><p>                document.getElementById('searchInput').addEventListener('input', (e) =&gt; {</p><p>                    this.filterProducts(e.target.value);</p><p>                });</p><p><br></p><p>                // 商品相关</p><p>                document.getElementById('addProductBtn').addEventListener('click', () =&gt; {</p><p>                    this.showProductModal();</p><p>                });</p><p><br></p><p>                document.getElementById('productForm').addEventListener('submit', (e) =&gt; {</p><p>                    e.preventDefault();</p><p>                    this.handleProductSubmit();</p><p>                });</p><p><br></p><p>                document.getElementById('cancelProductBtn').addEventListener('click', () =&gt; {</p><p>                    this.hideProductModal();</p><p>                });</p><p><br></p><p>                document.getElementById('productImage').addEventListener('change', (e) =&gt; {</p><p>                    this.handleImagePreview(e);</p><p>                });</p><p><br></p><p>                // 用户相关</p><p>                document.getElementById('addUserBtn').addEventListener('click', () =&gt; {</p><p>                    this.showUserModal();</p><p>                });</p><p><br></p><p>                document.getElementById('userForm').addEventListener('submit', (e) =&gt; {</p><p>                    e.preventDefault();</p><p>                    this.handleUserSubmit();</p><p>                });</p><p><br></p><p>                document.getElementById('cancelUserBtn').addEventListener('click', () =&gt; {</p><p>                    this.hideUserModal();</p><p>                });</p><p><br></p><p>                // 分类相关</p><p>                document.getElementById('addCategoryBtn').addEventListener('click', () =&gt; {</p><p>                    this.showCategoryModal();</p><p>                });</p><p><br></p><p>                document.getElementById('categoryForm').addEventListener('submit', (e) =&gt; {</p><p>                    e.preventDefault();</p><p>                    this.handleCategorySubmit();</p><p>                });</p><p><br></p><p>                document.getElementById('cancelCategoryBtn').addEventListener('click', () =&gt; {</p><p>                    this.hideCategoryModal();</p><p>                });</p><p><br></p><p>                // 确认删除相关</p><p>                document.getElementById('cancelConfirmBtn').addEventListener('click', () =&gt; {</p><p>                    this.hideConfirmModal();</p><p>                });</p><p><br></p><p>                document.getElementById('confirmDeleteBtn').addEventListener('click', () =&gt; {</p><p>                    if (this.confirmCallback) {</p><p>                        this.confirmCallback();</p><p>                        this.hideConfirmModal();</p><p>                    }</p><p>                });</p><p>            }</p><p><br></p><p>            async manualSync() {</p><p>                if (this.store.googleDrive.isSignedIn) {</p><p>                    await this.store.syncToCloud();</p><p>                    this.refreshAllViews();</p><p>                } else {</p><p>                    this.showAlert('请先连接 Google Drive');</p><p>                }</p><p>            }</p><p><br></p><p>            refreshAllViews() {</p><p>                // 刷新当前显示的内容</p><p>                const activeContent = document.querySelector('[id$="Content"]:not(.hidden)');</p><p>                if (activeContent) {</p><p>                    const activeId = activeContent.id;</p><p>                    if (activeId === 'dashboardContent') {</p><p>                        this.showDashboard();</p><p>                    } else if (activeId === 'userManagementContent') {</p><p>                        this.showUserManagement();</p><p>                    } else if (activeId === 'categoryManagementContent') {</p><p>                        this.showCategoryManagement();</p><p>                    } else if (activeId === 'statsContent') {</p><p>                        this.showStats();</p><p>                    }</p><p>                }</p><p>            }</p><p><br></p><p>            showLoginPage() {</p><p>                document.getElementById('loginPage').classList.remove('hidden');</p><p>                document.getElementById('mainApp').classList.add('hidden');</p><p>            }</p><p><br></p><p>            async showMainApp() {</p><p>                document.getElementById('loginPage').classList.add('hidden');</p><p>                document.getElementById('mainApp').classList.remove('hidden');</p><p>                </p><p>                // 尝试从云端加载数据</p><p>                await this.store.loadFromCloud();</p><p>                </p><p>                this.showDashboard();</p><p>                this.updateUserInfo();</p><p>                this.updateNavigation();</p><p>            }</p><p><br></p><p>            async handleLogin() {</p><p>                const username = document.getElementById('username').value;</p><p>                const password = document.getElementById('password').value;</p><p>                const errorElement = document.getElementById('loginError');</p><p><br></p><p>                const user = this.store.authenticate(username, password);</p><p>                if (user) {</p><p>                    await this.showMainApp();</p><p>                    errorElement.classList.add('hidden');</p><p>                    // 清除表单</p><p>                    document.getElementById('loginForm').reset();</p><p>                } else {</p><p>                    errorElement.textContent = '用户名或密码错误，或账户已被禁用';</p><p>                    errorElement.classList.remove('hidden');</p><p>                }</p><p>            }</p><p><br></p><p>            handleLogout() {</p><p>                this.store.logout();</p><p>                this.showLoginPage();</p><p>            }</p><p><br></p><p>            updateUserInfo() {</p><p>                const user = this.store.getCurrentUser();</p><p>                const roleText = user.role === 'admin' ? '管理员' : '员工';</p><p>                document.getElementById('userInfo').textContent = `${user.username} (${roleText})`;</p><p>            }</p><p><br></p><p>            updateNavigation() {</p><p>                const user = this.store.getCurrentUser();</p><p>                const userManagementBtn = document.getElementById('userManagementBtn');</p><p>                </p><p>                if (user.role === 'admin') {</p><p>                    userManagementBtn.classList.remove('hidden');</p><p>                } else {</p><p>                    userManagementBtn.classList.add('hidden');</p><p>                }</p><p>            }</p><p><br></p><p>            showDashboard() {</p><p>                this.setActiveNavItem('dashboardBtn');</p><p>                this.hideAllContent();</p><p>                document.getElementById('dashboardContent').classList.remove('hidden');</p><p>                this.updateProductCategories();</p><p>                this.renderProducts();</p><p>                this.updateStats();</p><p>            }</p><p><br></p><p>            showUserManagement() {</p><p>                this.setActiveNavItem('userManagementBtn');</p><p>                this.hideAllContent();</p><p>                document.getElementById('userManagementContent').classList.remove('hidden');</p><p>                this.renderUsers();</p><p>            }</p><p><br></p><p>            showCategoryManagement() {</p><p>                this.setActiveNavItem('categoryManagementBtn');</p><p>                this.hideAllContent();</p><p>                document.getElementById('categoryManagementContent').classList.remove('hidden');</p><p>                this.renderCategories();</p><p>            }</p><p><br></p><p>            showStats() {</p><p>                this.setActiveNavItem('statsBtn');</p><p>                this.hideAllContent();</p><p>                document.getElementById('statsContent').classList.remove('hidden');</p><p>                this.renderStats();</p><p>            }</p><p><br></p><p>            setActiveNavItem(activeId) {</p><p>                const navBtns = document.querySelectorAll('.nav-btn');</p><p>                navBtns.forEach(btn =&gt; {</p><p>                    if (btn.id === activeId) {</p><p>                        btn.classList.add('bg-primary', 'text-white');</p><p>                        btn.classList.remove('text-gray-600', 'dark:text-gray-400', 'hover:bg-gray-100', 'dark:hover:bg-gray-700');</p><p>                    } else {</p><p>                        btn.classList.remove('bg-primary', 'text-white');</p><p>                        btn.classList.add('text-gray-600', 'dark:text-gray-400', 'hover:bg-gray-100', 'dark:hover:bg-gray-700');</p><p>                    }</p><p>                });</p><p>            }</p><p><br></p><p>            hideAllContent() {</p><p>                document.getElementById('dashboardContent').classList.add('hidden');</p><p>                document.getElementById('userManagementContent').classList.add('hidden');</p><p>                document.getElementById('categoryManagementContent').classList.add('hidden');</p><p>                document.getElementById('statsContent').classList.add('hidden');</p><p>            }</p><p><br></p><p>            updateProductCategories() {</p><p>                const select = document.getElementById('productCategory');</p><p>                const categories = this.store.getCategories();</p><p>                </p><p>                select.innerHTML = '&lt;option value=""&gt;请选择分类&lt;/option&gt;';</p><p>                categories.forEach(category =&gt; {</p><p>                    const option = document.createElement('option');</p><p>                    option.value = category;</p><p>                    option.textContent = category;</p><p>                    select.appendChild(option);</p><p>                });</p><p>            }</p><p><br></p><p>            renderProducts(filterText = '') {</p><p>                const container = document.getElementById('productsList');</p><p>                const products = this.store.getProducts();</p><p>                const user = this.store.getCurrentUser();</p><p>                </p><p>                const filteredProducts = products.filter(product =&gt; </p><p>                    product.name.toLowerCase().includes(filterText.toLowerCase())</p><p>                );</p><p><br></p><p>                if (filteredProducts.length === 0) {</p><p>                    container.innerHTML = `</p><p>                        &lt;div class="text-center py-12 text-gray-500 dark:text-gray-400"&gt;</p><p>                            ${filterText ? '没有找到匹配的商品' : '暂无商品数据'}</p><p>                        &lt;/div&gt;</p><p>                    `;</p><p>                    return;</p><p>                }</p><p><br></p><p>                const productsHTML = filteredProducts.map(product =&gt; `</p><p>                    &lt;div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow"&gt;</p><p>                        &lt;div class="flex items-start space-x-4"&gt;</p><p>                            &lt;div class="flex-shrink-0"&gt;</p><p>                                ${product.image ? </p><p>                                    `&lt;img src="${product.image}" alt="${product.name}" class="product-image w-20 h-25 rounded-lg object-cover"&gt;` :</p><p>                                    `&lt;div class="product-image w-20 h-25 bg-gray-200 dark:bg-gray-700 rounded-lg flex items-center justify-center text-gray-400 text-xs"&gt;无图片&lt;/div&gt;`</p><p>                                }</p><p>                            &lt;/div&gt;</p><p>                            &lt;div class="flex-1 min-w-0"&gt;</p><p>                                &lt;h3 class="font-medium text-gray-900 dark:text-white truncate"&gt;${product.name}&lt;/h3&gt;</p><p>                                &lt;p class="text-sm text-gray-600 dark:text-gray-400 mt-1"&gt;分类: ${product.category}&lt;/p&gt;</p><p>                                &lt;p class="text-sm text-gray-600 dark:text-gray-400"&gt;价格: ¥${product.price}&lt;/p&gt;</p><p>                                &lt;p class="text-sm text-gray-600 dark:text-gray-400"&gt;库存: ${product.stock}&lt;/p&gt;</p><p>                                &lt;div class="mt-2"&gt;</p><p>                                    &lt;span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${product.sold ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' : 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200'}"&gt;</p><p>                                        ${product.sold ? '已售出' : '在售'}</p><p>                                    &lt;/span&gt;</p><p>                                &lt;/div&gt;</p><p>                            &lt;/div&gt;</p><p>                            &lt;div class="flex-shrink-0 flex flex-col space-y-2"&gt;</p><p>                                &lt;button onclick="app.editProduct(${product.id})" class="text-primary hover:text-primary/80 text-sm"&gt;编辑&lt;/button&gt;</p><p>                                ${user.role === 'admin' ? </p><p>                                    `&lt;button onclick="app.confirmDeleteProduct(${product.id})" class="text-red-500 hover:text-red-700 text-sm"&gt;删除&lt;/button&gt;` : </p><p>                                    ''</p><p>                                }</p><p>                            &lt;/div&gt;</p><p>                        &lt;/div&gt;</p><p>                    &lt;/div&gt;</p><p>                `).join('');</p><p><br></p><p>                container.innerHTML = productsHTML;</p><p>            }</p><p><br></p><p>            filterProducts(filterText) {</p><p>                this.renderProducts(filterText);</p><p>            }</p><p><br></p><p>            updateStats() {</p><p>                const products = this.store.getProducts();</p><p>                const total = products.length;</p><p>                const sold = products.filter(p =&gt; p.sold).length;</p><p>                const stock = products.filter(p =&gt; !p.sold).length;</p><p>                const totalValue = products.reduce((sum, p) =&gt; sum + (p.price * p.stock), 0);</p><p><br></p><p>                document.getElementById('totalProducts').textContent = total;</p><p>                document.getElementById('soldProducts').textContent = sold;</p><p>                document.getElementById('stockProducts').textContent = stock;</p><p>                document.getElementById('totalValue').textContent = `¥${totalValue.toFixed(2)}`;</p><p>            }</p><p><br></p><p>            showProductModal(product = null) {</p><p>                this.currentEditingProduct = product;</p><p>                const modal = document.getElementById('productModal');</p><p>                const title = document.getElementById('productModalTitle');</p><p>                const form = document.getElementById('productForm');</p><p><br></p><p>                title.textContent = product ? '编辑商品' : '添加商品';</p><p>                </p><p>                if (product) {</p><p>                    document.getElementById('productName').value = product.name;</p><p>                    document.getElementById('productCategory').value = product.category;</p><p>                    document.getElementById('productPrice').value = product.price;</p><p>                    document.getElementById('productStock').value = product.stock;</p><p>                    document.getElementById('productSold').checked = product.sold;</p><p>                    </p><p>                    if (product.image) {</p><p>                        document.getElementById('imagePreview').classList.remove('hidden');</p><p>                        document.getElementById('previewImg').src = product.image;</p><p>                    }</p><p>                } else {</p><p>                    form.reset();</p><p>                    document.getElementById('imagePreview').classList.add('hidden');</p><p>                }</p><p><br></p><p>                modal.classList.remove('hidden');</p><p>            }</p><p><br></p><p>            hideProductModal() {</p><p>                document.getElementById('productModal').classList.add('hidden');</p><p>                document.getElementById('productForm').reset();</p><p>                document.getElementById('imagePreview').classList.add('hidden');</p><p>                this.currentEditingProduct = null;</p><p>            }</p><p><br></p><p>            handleImagePreview(event) {</p><p>                const file = event.target.files[0];</p><p>                if (file) {</p><p>                    const reader = new FileReader();</p><p>                    reader.onload = (e) =&gt; {</p><p>                        // 创建图片对象来调整尺寸</p><p>                        const img = new Image();</p><p>                        img.onload = () =&gt; {</p><p>                            const canvas = document.createElement('canvas');</p><p>                            const ctx = canvas.getContext('2d');</p><p>                            </p><p>                            // 设置目标尺寸</p><p>                            canvas.width = 1600;</p><p>                            canvas.height = 2048;</p><p>                            </p><p>                            // 计算缩放比例以保持纵横比</p><p>                            const scaleX = canvas.width / img.width;</p><p>                            const scaleY = canvas.height / img.height;</p><p>                            const scale = Math.min(scaleX, scaleY);</p><p>                            </p><p>                            const scaledWidth = img.width * scale;</p><p>                            const scaledHeight = img.height * scale;</p><p>                            </p><p>                            // 居中绘制</p><p>                            const x = (canvas.width - scaledWidth) / 2;</p><p>                            const y = (canvas.height - scaledHeight) / 2;</p><p>                            </p><p>                            // 填充白色背景</p><p>                            ctx.fillStyle = 'white';</p><p>                            ctx.fillRect(0, 0, canvas.width, canvas.height);</p><p>                            </p><p>                            // 绘制图片</p><p>                            ctx.drawImage(img, x, y, scaledWidth, scaledHeight);</p><p>                            </p><p>                            // 获取调整后的图片数据</p><p>                            const resizedDataUrl = canvas.toDataURL('image/jpeg', 0.8);</p><p>                            </p><p>                            document.getElementById('imagePreview').classList.remove('hidden');</p><p>                            document.getElementById('previewImg').src = resizedDataUrl;</p><p>                            </p><p>                            // 保存调整后的图片数据</p><p>                            event.target.dataset.resizedImage = resizedDataUrl;</p><p>                        };</p><p>                        img.src = e.target.result;</p><p>                    };</p><p>                    reader.readAsDataURL(file);</p><p>                }</p><p>            }</p><p><br></p><p>            handleProductSubmit() {</p><p>                const name = document.getElementById('productName').value;</p><p>                const category = document.getElementById('productCategory').value;</p><p>                const price = parseFloat(document.getElementById('productPrice').value);</p><p>                const stock = parseInt(document.getElementById('productStock').value);</p><p>                const sold = document.getElementById('productSold').checked;</p><p>                const imageInput = document.getElementById('productImage');</p><p>                </p><p>                let image = null;</p><p>                if (imageInput.dataset.resizedImage) {</p><p>                    image = imageInput.dataset.resizedImage;</p><p>                } else if (this.currentEditingProduct) {</p><p>                    image = this.currentEditingProduct.image;</p><p>                }</p><p><br></p><p>                const productData = { name, image, category, price, stock, sold };</p><p><br></p><p>                if (this.currentEditingProduct) {</p><p>                    this.store.updateProduct(this.currentEditingProduct.id, productData);</p><p>                } else {</p><p>                    this.store.addProduct(productData);</p><p>                }</p><p><br></p><p>                this.hideProductModal();</p><p>                this.renderProducts();</p><p>                this.updateStats();</p><p>            }</p><p><br></p><p>            editProduct(id) {</p><p>                const product = this.store.getProducts().find(p =&gt; p.id === id);</p><p>                if (product) {</p><p>                    this.showProductModal(product);</p><p>                }</p><p>            }</p><p><br></p><p>            confirmDeleteProduct(id) {</p><p>                this.showConfirmModal('确定要删除此商品吗？', () =&gt; {</p><p>                    this.store.deleteProduct(id);</p><p>                    this.renderProducts();</p><p>                    this.updateStats();</p><p>                });</p><p>            }</p><p><br></p><p>            // 用户管理相关方法</p><p>            renderUsers() {</p><p>                const container = document.getElementById('usersList');</p><p>                const users = this.store.getUsers();</p><p>                const currentUser = this.store.getCurrentUser();</p><p><br></p><p>                const usersHTML = users.map(user =&gt; `</p><p>                    &lt;div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow"&gt;</p><p>                        &lt;div class="flex items-center justify-between"&gt;</p><p>                            &lt;div&gt;</p><p>                                &lt;h3 class="font-medium text-gray-900 dark:text-white"&gt;${user.username}&lt;/h3&gt;</p><p>                                &lt;p class="text-sm text-gray-600 dark:text-gray-400"&gt;</p><p>                                    角色: ${user.role === 'admin' ? '管理员' : '员工'}</p><p>                                &lt;/p&gt;</p><p>                                &lt;div class="mt-2"&gt;</p><p>                                    &lt;span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${user.status === 'active' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' : 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'}"&gt;</p><p>                                        ${user.status === 'active' ? '启用' : '禁用'}</p><p>                                    &lt;/span&gt;</p><p>                                &lt;/div&gt;</p><p>                            &lt;/div&gt;</p><p>                            &lt;div class="flex flex-col space-y-2"&gt;</p><p>                                ${user.id !== currentUser.id ? `</p><p>                                    &lt;button onclick="app.toggleUserStatus(${user.id})" class="text-primary hover:text-primary/80 text-sm"&gt;</p><p>                                        ${user.status === 'active' ? '禁用' : '启用'}</p><p>                                    &lt;/button&gt;</p><p>                                    &lt;button onclick="app.editUser(${user.id})" class="text-primary hover:text-primary/80 text-sm"&gt;编辑&lt;/button&gt;</p><p>                                    &lt;button onclick="app.confirmDeleteUser(${user.id})" class="text-red-500 hover:text-red-700 text-sm"&gt;删除&lt;/button&gt;</p><p>                                ` : ''}</p><p>                            &lt;/div&gt;</p><p>                        &lt;/div&gt;</p><p>                    &lt;/div&gt;</p><p>                `).join('');</p><p><br></p><p>                container.innerHTML = usersHTML;</p><p>            }</p><p><br></p><p>            showUserModal(user = null) {</p><p>                this.currentEditingUser = user;</p><p>                const modal = document.getElementById('userModal');</p><p>                const title = document.getElementById('userModalTitle');</p><p>                const form = document.getElementById('userForm');</p><p><br></p><p>                title.textContent = user ? '编辑用户' : '添加员工';</p><p>                </p><p>                if (user) {</p><p>                    document.getElementById('newUsername').value = user.username;</p><p>                    document.getElementById('newPassword').value = user.password;</p><p>                    document.getElementById('userRole').value = user.role;</p><p>                } else {</p><p>                    form.reset();</p><p>                }</p><p><br></p><p>                modal.classList.remove('hidden');</p><p>            }</p><p><br></p><p>            hideUserModal() {</p><p>                document.getElementById('userModal').classList.add('hidden');</p><p>                document.getElementById('userForm').reset();</p><p>                this.currentEditingUser = null;</p><p>            }</p><p><br></p><p>            handleUserSubmit() {</p><p>                const username = document.getElementById('newUsername').value;</p><p>                const password = document.getElementById('newPassword').value;</p><p>                const role = document.getElementById('userRole').value;</p><p><br></p><p>                const userData = { username, password, role };</p><p><br></p><p>                if (this.currentEditingUser) {</p><p>                    this.store.updateUser(this.currentEditingUser.id, userData);</p><p>                } else {</p><p>                    this.store.addUser(userData);</p><p>                }</p><p><br></p><p>                this.hideUserModal();</p><p>                this.renderUsers();</p><p>            }</p><p><br></p><p>            editUser(id) {</p><p>                const user = this.store.getUsers().find(u =&gt; u.id === id);</p><p>                if (user) {</p><p>                    this.showUserModal(user);</p><p>                }</p><p>            }</p><p><br></p><p>            toggleUserStatus(id) {</p><p>                const user = this.store.getUsers().find(u =&gt; u.id === id);</p><p>                if (user) {</p><p>                    const newStatus = user.status === 'active' ? 'disabled' : 'active';</p><p>                    this.store.updateUser(id, { status: newStatus });</p><p>                    this.renderUsers();</p><p>                }</p><p>            }</p><p><br></p><p>            confirmDeleteUser(id) {</p><p>                this.showConfirmModal('确定要删除此用户吗？', () =&gt; {</p><p>                    this.store.deleteUser(id);</p><p>                    this.renderUsers();</p><p>                });</p><p>            }</p><p><br></p><p>            // 分类管理相关方法</p><p>            renderCategories() {</p><p>                const container = document.getElementById('categoriesList');</p><p>                const categories = this.store.getCategories();</p><p><br></p><p>                const categoriesHTML = categories.map(category =&gt; `</p><p>                    &lt;div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow"&gt;</p><p>                        &lt;div class="flex items-center justify-between"&gt;</p><p>                            &lt;div&gt;</p><p>                                &lt;h3 class="font-medium text-gray-900 dark:text-white"&gt;${category}&lt;/h3&gt;</p><p>                            &lt;/div&gt;</p><p>                            &lt;div&gt;</p><p>                                &lt;button onclick="app.confirmDeleteCategory('${category}')" class="text-red-500 hover:text-red-700 text-sm"&gt;删除&lt;/button&gt;</p><p>                            &lt;/div&gt;</p><p>                        &lt;/div&gt;</p><p>                    &lt;/div&gt;</p><p>                `).join('');</p><p><br></p><p>                container.innerHTML = categoriesHTML || '&lt;div class="text-center py-12 text-gray-500 dark:text-gray-400"&gt;暂无分类&lt;/div&gt;';</p><p>            }</p><p><br></p><p>            showCategoryModal() {</p><p>                const modal = document.getElementById('categoryModal');</p><p>                const form = document.getElementById('categoryForm');</p><p>                </p><p>                form.reset();</p><p>                modal.classList.remove('hidden');</p><p>            }</p><p><br></p><p>            hideCategoryModal() {</p><p>                document.getElementById('categoryModal').classList.add('hidden');</p><p>                document.getElementById('categoryForm').reset();</p><p>            }</p><p><br></p><p>            handleCategorySubmit() {</p><p>                const name = document.getElementById('categoryName').value;</p><p>                </p><p>                if (this.store.addCategory(name)) {</p><p>                    this.hideCategoryModal();</p><p>                    this.renderCategories();</p><p>                    this.updateProductCategories();</p><p>                } else {</p><p>                    this.showAlert('分类已存在');</p><p>                }</p><p>            }</p><p><br></p><p>            confirmDeleteCategory(categoryName) {</p><p>                this.showConfirmModal('确定要删除此分类吗？', () =&gt; {</p><p>                    this.store.deleteCategory(categoryName);</p><p>                    this.renderCategories();</p><p>                    this.updateProductCategories();</p><p>                });</p><p>            }</p><p><br></p><p>            // 统计相关方法</p><p>            renderStats() {</p><p>                const products = this.store.getProducts();</p><p>                const categories = this.store.getCategories();</p><p>                </p><p>                // 分类统计</p><p>                const categoryStats = categories.map(category =&gt; {</p><p>                    const categoryProducts = products.filter(p =&gt; p.category === category);</p><p>                    const total = categoryProducts.length;</p><p>                    const sold = categoryProducts.filter(p =&gt; p.sold).length;</p><p>                    const revenue = categoryProducts.filter(p =&gt; p.sold).reduce((sum, p) =&gt; sum + p.price, 0);</p><p>                    </p><p>                    return { category, total, sold, revenue };</p><p>                });</p><p><br></p><p>                const categoryStatsHTML = categoryStats.map(stat =&gt; `</p><p>                    &lt;div class="border-b border-gray-200 dark:border-gray-700 pb-3 mb-3 last:border-b-0"&gt;</p><p>                        &lt;div class="flex justify-between items-center"&gt;</p><p>                            &lt;span class="font-medium"&gt;${stat.category}&lt;/span&gt;</p><p>                            &lt;span class="text-sm text-gray-600 dark:text-gray-400"&gt;${stat.total} 件商品&lt;/span&gt;</p><p>                        &lt;/div&gt;</p><p>                        &lt;div class="text-sm text-gray-600 dark:text-gray-400 mt-1"&gt;</p><p>                            已售: ${stat.sold} 件 | 收入: ¥${stat.revenue.toFixed(2)}</p><p>                        &lt;/div&gt;</p><p>                    &lt;/div&gt;</p><p>                `).join('');</p><p><br></p><p>                document.getElementById('categoryStats').innerHTML = categoryStatsHTML || '&lt;div class="text-gray-500 dark:text-gray-400"&gt;暂无数据&lt;/div&gt;';</p><p><br></p><p>                // 销售统计</p><p>                const totalRevenue = products.filter(p =&gt; p.sold).reduce((sum, p) =&gt; sum + p.price, 0);</p><p>                const avgPrice = products.length &gt; 0 ? products.reduce((sum, p) =&gt; sum + p.price, 0) / products.length : 0;</p><p>                </p><p>                const salesStatsHTML = `</p><p>                    &lt;div class="space-y-4"&gt;</p><p>                        &lt;div class="border-b border-gray-200 dark:border-gray-700 pb-3"&gt;</p><p>                            &lt;div class="text-2xl font-bold text-primary"&gt;¥${totalRevenue.toFixed(2)}&lt;/div&gt;</p><p>                            &lt;div class="text-sm text-gray-600 dark:text-gray-400"&gt;总收入&lt;/div&gt;</p><p>                        &lt;/div&gt;</p><p>                        &lt;div class="border-b border-gray-200 dark:border-gray-700 pb-3"&gt;</p><p>                            &lt;div class="text-2xl font-bold text-green-500"&gt;¥${avgPrice.toFixed(2)}&lt;/div&gt;</p><p>                            &lt;div class="text-sm text-gray-600 dark:text-gray-400"&gt;平均商品价格&lt;/div&gt;</p><p>                        &lt;/div&gt;</p><p>                        &lt;div&gt;</p><p>                            &lt;div class="text-2xl font-bold text-blue-500"&gt;${products.filter(p =&gt; p.sold).length}&lt;/div&gt;</p><p>                            &lt;div class="text-sm text-gray-600 dark:text-gray-400"&gt;已售商品数量&lt;/div&gt;</p><p>                        &lt;/div&gt;</p><p>                    &lt;/div&gt;</p><p>                `;</p><p><br></p><p>                document.getElementById('salesStats').innerHTML = salesStatsHTML;</p><p>            }</p><p><br></p><p>            // 通用确认模态框</p><p>            showConfirmModal(message, callback) {</p><p>                document.getElementById('confirmMessage').textContent = message;</p><p>                document.getElementById('confirmModal').classList.remove('hidden');</p><p>                this.confirmCallback = callback;</p><p>            }</p><p><br></p><p>            hideConfirmModal() {</p><p>                document.getElementById('confirmModal').classList.add('hidden');</p><p>                this.confirmCallback = null;</p><p>            }</p><p><br></p><p>            // 通用提示</p><p>            showAlert(message) {</p><p>                const alertModal = document.createElement('div');</p><p>                alertModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal-overlay';</p><p>                alertModal.innerHTML = `</p><p>                    &lt;div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-sm mx-4"&gt;</p><p>                        &lt;div class="p-6"&gt;</p><p>                            &lt;h3 class="text-lg font-semibold mb-4"&gt;提示&lt;/h3&gt;</p><p>                            &lt;p class="text-gray-600 dark:text-gray-400 mb-6"&gt;${message}&lt;/p&gt;</p><p>                            &lt;div class="flex justify-end"&gt;</p><p>                                &lt;button onclick="this.closest('.fixed').remove()" class="px-4 py-2 bg-primary text-white hover:bg-primary/90 rounded-lg"&gt;确定&lt;/button&gt;</p><p>                            &lt;/div&gt;</p><p>                        &lt;/div&gt;</p><p>                    &lt;/div&gt;</p><p>                `;</p><p>                document.body.appendChild(alertModal);</p><p>            }</p><p>        }</p><p><br></p><p>        // 初始化应用</p><p>        const app = new InventoryApp();</p><p>    &lt;/script&gt;</p><p>&lt;/body&gt;</p><p>&lt;/html&gt;</p><p><br></p>